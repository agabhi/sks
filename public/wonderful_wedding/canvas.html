<!DOCTYPE html>
<html lang="en-US">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Wonderful Wedding</title>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="crossorigin" />
  <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Dosis:wght@400;500&amp;display=swap" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Dosis:wght@400;500&amp;display=swap"
    media="print" onload="this.media='all'" />
  <noscript>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Dosis:wght@400;500&amp;display=swap" />
  </noscript>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="crossorigin" />
  <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Great+Vibes&amp;display=swap" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="crossorigin" />
  <link
    href="https://fonts.googleapis.com/css2?family=Dosis:wght@400;500&family=Great+Vibes&family=Roboto:wght@400;700&family=Lobster&family=Pacifico&family=Oswald:wght@400;500&family=Merriweather:wght@400;700&family=Montserrat:wght@400;700&family=Raleway:wght@400;700&family=Open+Sans:wght@400;700&family=Playfair+Display:wght@400;700&family=Lato:wght@400;700&family=Poppins:wght@400;700&display=swap"
    rel="stylesheet">

  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Great+Vibes&amp;display=swap" media="print"
    onload="this.media='all'" />
  <noscript>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Great+Vibes&amp;display=swap" />
  </noscript>
  <link rel="apple-touch-icon" sizes="180x180" href="images/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="images/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="images/favicon/favicon-16x16.png">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link href="css/bootstrap.min.css?ver=1.1.0" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link href="css/aos.css?ver=1.1.0" rel="stylesheet">
  <link href="css/ekko-lightbox.css?ver=1.1.0" rel="stylesheet">
  <link href="css/main.css?ver=1.1.0" rel="stylesheet">
  <noscript>
    <style type="text/css">
      [data-aos] {
        opacity: 1 !important;
        transform: translate(0) scale(1) !important;
      }
    </style>
  </noscript>
</head>

<body id="top">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>



  <div class="offcanvas offcanvas-end" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1"
    id="offcanvasScrolling" aria-labelledby="offcanvasScrollingLabel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="offcanvasScrollingLabel">Offcanvas with body scrolling</h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
      <div class="container">
        <div class="row">
          <div class="col card" style="width: 18rem;border:0px;">
            <img class="card-img-top" src="../images/template1.png" alt="Card image cap"
              onclick="loadImageToCanvas(this.src)">

            <div class="card-body">
              <p class="card-text">Template 1</p>
            </div>
          </div>
          <div class="col card" style="width: 18rem;border:0px;">
            <img class="card-img-top" src="../images/template_2.png" alt="Card image cap"
              onclick="loadImageToCanvas(this.src)">
            <div class="card-body">
              <p class="card-text">Template 2</p>
            </div>
          </div>

        </div>
        <div class="row">
          <div class="col card" style="width: 18rem;border:0px;">
            <img class="card-img-top" src="../images/template_3.png" alt="Card image cap"
              onclick="loadImageToCanvas(this.src)">
            <div class="card-body">
              <p class="card-text">Template 3</p>
            </div>
          </div>
          <div class="col card" style="width: 18rem;border:0px;">
            <img class="card-img-top" src="../images/template_4.png" alt="Card image cap"
              onclick="loadImageToCanvas(this.src)">
            <div class="card-body">
              <p class="card-text">Template 4</p>
            </div>
          </div>

        </div>

      </div>
    </div>
  </div>
  <header></header>
  <div class="page-content">
    <div class="div">
      <div class="ww-nav-bar sticky-top bg-light">
        <nav class="navbar navbar-expand-lg navbar-light">
          <div class="container"><a href="#"><svg class="heart" viewBox="0 0 32 29.6">
                <path
                  d="M23.6,0c-3.4,0-6.3,2.7-7.6,5.6C14.7,2.7,11.8,0,8.4,0C3.8,0,0,3.8,0,8.4c0,9.4,9.5,11.9,16,21.2c6.1-9.3,16-12.1,16-21.2C32,3.8,28.2,0,23.6,0z" />
              </svg></a>
            <h1 class="h2"><a class="pl-4 navbar-brand" href="#">Shaadi Ki Stationary</a></h1>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#ww-navbarNav"
              aria-controls="ww-navbarNav" aria-expanded="false" aria-label="Toggle navigation"><span
                class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse text-uppercase" id="ww-navbarNav">
              <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                  <button class="btn btn-primary" type="button" data-bs-toggle="offcanvas"
                    data-bs-target="#offcanvasScrolling" aria-controls="offcanvasScrolling">Change Template</button>
                </li>

              </ul>
            </div>
          </div>
        </nav>
      </div>
      <div class="ww-section" style="padding-top: 50px; background-color: #e9ecef;height: 900px;;" id="couple">


        <div class="container-fluid">
          <div class="row">
            <div id="slideDown" class="slide-down" style="height: 40px;">
              <div class="icon-buttons">
                <button id="cropBtn" class="icon-button"><i class="fas fa-crop-alt"></i> Crop</button>
                <button id="replaceBtn" class="icon-button"><i class="fas fa-sync-alt"></i> Replace</button>
                <button id="deleteBtn" class="icon-button"><i class="fas fa-trash-alt"></i> Delete</button>
                <button id="downloadBtn" class="icon-button"><i class="fas fa-download"></i> Download</button>
                <button id="closeBtn" class="icon-button"><i class="fas fa-times"></i> Close</button>
              </div>
            </div>
          </div>


        </div>

        <div class="row text-center">
          <div class="col-md-3">
            <div class="row">
              <div class="col-md-auto">
                <div>
                  <a id="textIcon" class="btn btn-link" style="font-size: 2rem" href="#"><i class="fa-solid fa-font"
                      aria-hidden="true"></i></a>
                </div>
                <div>
                  <a id="imageIcon" class="btn btn-link" style="font-size: 2rem" href="#"><i class="fa-solid fa-image"
                      aria-hidden="true"></i></a>
                </div>
              </div>
              <div class="col md-6"
                style="box-shadow: 0 5px 10px #0000001a;padding: 20px; background-color: #f8f9fa!important;">
                <div id="textOptions">
                  <div>
                    <h4>Text</h4>
                    <div id="text-areas">

                    </div>
                    <br />
                    <div>
                      <button id="addTextButton" class="btn btn-primary btn-submit" type="submit">Add Text</button>
                    </div>
                  </div>

                </div>
                <div id="imageOptions" style="display:none">
                  <h4>Add Image</h4>
                  <div>
                    <input type="file" id="fileInput" accept="image/*">
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-9">
            <div class="row">
              <div class="col md-6 pb-3">
                <!-- <div class="container"style="height:200px">
                    <div class="row">
                      <div class="col-md-1" style="background-color: orange";>
                        Hello
                      </div>
                    </div>
                  </div> -->
                <div class="form-group">
                  <div style="height:100px;width:100%;">
                    <canvas id="canvas" width="500" height="400"></canvas>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>


    <div class="ww-footer bg-light">
      <div class="container text-center py-4">
        <p class="my-0">&copy; Wonderful Wedding. All rights reserved.</p>
        <p class="mb-0">Design - <a class="credit" href="https://templateflip.com" target="_blank">TemplateFlip</a>
        </p>
      </div>
    </div>
  </div>

  </div>
  <div id="fontSelectionPanel">
    <div class="font-option" style="font-family: 'Roboto';" onclick="selectFont('Roboto')">Roboto</div>
    <div class="font-option" style="font-family: 'Lobster';" onclick="selectFont('Lobster')">Lobster</div>
    <div class="font-option" style="font-family: 'Pacifico';" onclick="selectFont('Pacifico')">Pacifico</div>
    <div class="font-option" style="font-family: 'Oswald';" onclick="selectFont('Oswald')">Oswald</div>
    <div class="font-option" style="font-family: 'Merriweather';" onclick="selectFont('Merriweather')">Merriweather
    </div>
    <div class="font-option" style="font-family: 'Montserrat';" onclick="selectFont('Montserrat')">Montserrat</div>
    <div class="font-option" style="font-family: 'Raleway';" onclick="selectFont('Raleway')">Raleway</div>
    <div class="font-option" style="font-family: 'Open Sans';" onclick="selectFont('Open Sans')">Open Sans</div>
    <div class="font-option" style="font-family: 'Playfair Display';" onclick="selectFont('Playfair Display')">Playfair
      Display</div>
    <div class="font-option" style="font-family: 'Lato';" onclick="selectFont('Lato')">Lato</div>
    <div class="font-option" style="font-family: 'Poppins';" onclick="selectFont('Poppins')">Poppins</div>
    <!-- Add more fonts as needed -->
  </div>
  <footer></footer>
  <script src="scripts/jquery.min.js?ver=1.1.0"></script>
  <script src="scripts/bootstrap.bundle.min.js?ver=1.1.0"></script>
  <script src="scripts/aos.js?ver=1.1.0"></script>
  <script src="scripts/ekko-lightbox.min.js?ver=1.1.0"></script>
  <script src="scripts/main.js?ver=1.1.0"></script>


  <script>
    document.getElementById('imageIcon').addEventListener('click', function () {
      document.getElementById('imageOptions').style.display = 'block';
      document.getElementById('textOptions').style.display = 'none';
    });

    document.getElementById('textIcon').addEventListener('click', function () {
      document.getElementById('textOptions').style.display = 'block';
      document.getElementById('imageOptions').style.display = 'none';
    });

    const fileInput = document.getElementById('fileInput');
    const textInput = document.getElementById('textInput');
    const fontSelect = document.getElementById('fontSelect');
    const colorPicker = document.getElementById('colorPicker');
    const addTextButton = document.getElementById('addTextButton');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const slideDown = document.getElementById('slideDown');
    const closeBtn = document.getElementById('closeBtn');
    const cropBtn = document.getElementById('cropBtn');
    const replaceBtn = document.getElementById('replaceBtn');
    const deleteBtn = document.getElementById('deleteBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const textAreas = document.getElementById('text-areas');
    const extraOptions = document.getElementById('extraOptions');
    const changeTemplateButton = document.getElementById('changeTemplateButton');
    const templatePanel = document.getElementById('templatePanel');
    const templateCloseBtn = document.getElementById('templateCloseBtn');
    const templateThumbnails = document.querySelectorAll('.template-thumbnail');

    //var myOffcanvas = document.getElementById('slideDownId')
    //var slideDownBar = new bootstrap.Offcanvas(myOffcanvas)


    let img = new Image();
    img.src = '../images/template1.png';
    let texts = []; // Array to hold text objects
    let selectedTextIndex = -1; // Index of the selected text
    let images = [];
    let selectedImage = null;
    let dragging = false;
    let resizing = false;
    let dragOffsetX, dragOffsetY;
    let resizeStartWidth, resizeStartHeight;
    let initialAspectRatio;

    fileInput.addEventListener('change', function (e) {
      const files = event.target.files;
      for (let i = 0; i < files.length; i++) {
        let file = files[i];
        let reader = new FileReader();
        reader.onload = function(e) {
          let img = new Image();
          img.onload = function() {
            addImageToCanvas(img);
          };
          img.src = e.target.result;
        };
        reader.readAsDataURL(file);
      }
    });

    function addImageToCanvas(img) {
      const maxWidth = 100;
      const aspectRatio = img.width / img.height;
      const width = maxWidth;
      const height = maxWidth / aspectRatio;
      const x = Math.random() * (canvas.width - width);
      const y = Math.random() * (canvas.height - height);

      ctx.drawImage(img, x, y, width, height);

      images.push({ img, x, y, width, height });
    }

    function onCanvasMouseDown(e) {
      const { offsetX: mouseX, offsetY: mouseY } = e;
      selectedImage = null;
      images.forEach(image => {
        if (
          mouseX >= image.x &&
          mouseX <= image.x + image.width &&
          mouseY >= image.y &&
          mouseY <= image.y + image.height
        ) {
          selectedImage = image;
        }
      });

      if (selectedImage) {
        dragOffsetX = mouseX - selectedImage.x;
        dragOffsetY = mouseY - selectedImage.y;
        initialAspectRatio = selectedImage.width / selectedImage.height;

        if (isMouseNearBorder(mouseX, mouseY, selectedImage)) {
          resizing = true;
          resizeStartWidth = selectedImage.width;
          resizeStartHeight = selectedImage.height;
        } else {
          dragging = true;
        }
      }

      drawCanvas();
    }

    function onCanvasMouseMove(e) {
      if (dragging && selectedImage) {
        selectedImage.x = e.offsetX - dragOffsetX;
        selectedImage.y = e.offsetY - dragOffsetY;
        redrawCanvas();
      } else if (resizing && selectedImage) {
        const newWidth = Math.max(e.offsetX - selectedImage.x, 10);
        const newHeight = newWidth / initialAspectRatio;
        selectedImage.width = newWidth;
        selectedImage.height = newHeight;
        drawCanvas();
      }
    }

    function onCanvasMouseUp() {
      dragging = false;
      resizing = false;
    }

    

    function drawSelectionBorder(image) {
      ctx.strokeStyle = 'blue';
      ctx.lineWidth = 2;
      ctx.strokeRect(image.x, image.y, image.width, image.height);
    }

    function isMouseNearBorder(mouseX, mouseY, image) {
      const near = 8; // Define how close the mouse should be to the border
      return (
        mouseX >= image.x + image.width - near &&
        mouseX <= image.x + image.width + near &&
        mouseY >= image.y &&
        mouseY <= image.y + image.height
      );
    }

    function drawCanvas() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      if (img.src) {
        // Calculate the new canvas dimensions while maintaining the aspect ratio
        var maxWidth = 300;
        var ratio = img.width / img.height;
        canvas.width = maxWidth;
        canvas.height = maxWidth / ratio;
        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
      }
      images.forEach(image => {
        ctx.drawImage(image.img, image.x, image.y, image.width, image.height);
        if (image === selectedImage) {
          drawSelectionBorder(image);
        }
      });
      texts.forEach((textObj, index) => {
        addTextToCanvas(textObj, index === selectedTextIndex);
      });
    }

    function addTextToCanvas(textObj, isSelected) {
      ctx.font = `${textObj.fontSize}px ${textObj.fontFamily}`;
      ctx.fillStyle = textObj.color;
      ctx.fillText(textObj.text, textObj.x, textObj.y);


      if (isSelected) {
        const textWidth = ctx.measureText(textObj.text).width;
        const textHeight = parseInt(ctx.font, 10);
        ctx.strokeStyle = 'blue';
        ctx.lineWidth = 2;
        ctx.strokeRect(textObj.x, textObj.y - textHeight, textWidth, textHeight);
      }
    }

    const dragStart = (event) => {
      const rect = canvas.getBoundingClientRect();
      const x = event.clientX - rect.left;
      const y = event.clientY - rect.top;
      texts.forEach((textObj, index) => {
        const textWidth = ctx.measureText(textObj.text).width;
        const textHeight = parseInt(ctx.font, 10);
        if (x >= textObj.x && x <= textObj.x + textWidth && y >= textObj.y - textHeight && y <= textObj.y) {
          textObj.isDragging = true;
          selectedTextIndex = index;
        }
      });
    };

    const dragEnd = () => {
      texts.forEach((textObj) => {
        textObj.isDragging = false;
      });
    };

    const drag = (event) => {
      if (selectedTextIndex !== -1 && texts[selectedTextIndex].isDragging) {
        const rect = canvas.getBoundingClientRect();
        const x = event.clientX - rect.left;
        const y = event.clientY - rect.top;
        texts[selectedTextIndex].x = x;
        texts[selectedTextIndex].y = y;
        drawCanvas();
      }
    };

    canvas.addEventListener('mousedown', dragStart);
    canvas.addEventListener('mouseup', dragEnd);
    canvas.addEventListener('mousemove', drag);

    canvas.addEventListener('mousedown', onCanvasMouseDown);
    canvas.addEventListener('mousemove', onCanvasMouseMove);
    canvas.addEventListener('mouseup', onCanvasMouseUp);

    function drawText() {
      if (text) {
        const lines = text.split('\n');
        const fontSize = 20;
        ctx.font = `${fontSize}px ${fontSelect.value}`;
        ctx.fillStyle = colorPicker.value;
        lines.forEach((line, index) => {
          ctx.fillText(line, textPosition.x, textPosition.y + (index * (fontSize + 5)));
        });
      }
    }

    addTextButton.addEventListener('click', function () {
      createNewText();
    });

    function addTextToCanvas(textObj) {
      ctx.font = `${textObj.fontSize}px ${textObj.fontFamily}`;
      ctx.fillStyle = textObj.color;
      ctx.fillText(textObj.text, textObj.x, textObj.y);
    }

    function addTextArea(textObj) {
      const textArea = document.createElement('textarea');
      textArea.value = textObj.text;
      textArea.classList = ["form-control"];
      //textArea.style.fontFamily = textObj.fontFamily;
      //textArea.style.color = textObj.color;
      //textArea.style.display = 'block';
      textArea.addEventListener('input', function () {
        textObj.text = textArea.value;
        drawCanvas();
      });
      textAreas.appendChild(textArea);
      drawCanvas();
    }

    function createNewText(text) {
      const newText = {
        text: text ? text : 'New Text',
        x: 50,
        y: 50,
        fontSize: 20,
        fontFamily: 'Arial',
        color: '#000000',
        isDragging: false,
        selected: false
      };
      texts.push(newText);
      addTextArea(newText);
    }


    // Function to change the font of all texts on the canvas
    function changeFont(fontFamily) {
      texts.forEach(textObj => {
        textObj.fontFamily = fontFamily;
      });
      drawCanvas();
    }

    canvas.addEventListener('click', function (event) {
      const rect = canvas.getBoundingClientRect();
      const x = event.clientX - rect.left;
      const y = event.clientY - rect.top;

      // Show the slide down menu
      slideDown.classList.add('show');
    });
    drawCanvas();

    function showFontSelection() {
      document.getElementById('fontSelectionPanel').style.display = 'block';
    }

    function selectFont(fontFamily) {
      changeFont(fontFamily);
      document.getElementById('fontSelectionPanel').style.display = 'none';
    }

    cropBtn.addEventListener('click', function () {
      showFontSelection();
    });

  </script>
  <script>

    function loadImageToCanvas(src) {
      var canvas = document.getElementById('canvas');
      var context = canvas.getContext('2d');
      var img = new Image();
      img.onload = function () {
        // Calculate the new canvas dimensions while maintaining the aspect ratio
        var maxWidth = 300;
        var ratio = img.width / img.height;
        canvas.width = maxWidth;
        canvas.height = maxWidth / ratio;
        context.clearRect(0, 0, canvas.width, canvas.height); // Clear the canvas
        context.drawImage(img, 0, 0, canvas.width, canvas.height);
      };
      img.src = src;
    }
  </script>

</body>

</html>